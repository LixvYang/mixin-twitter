(function(){"use strict";var t={336:function(t,e,n){var o=n(9242),i=n(3396);const r={class:"app"};function a(t,e,n,o,a,s){const c=(0,i.up)("Main");return(0,i.wg)(),(0,i.iD)("div",r,[(0,i.Wm)(c)])}var s=n(6047),c=(0,i.aZ)({name:"App",components:{Main:s["default"]},setup(){return{Main:s["default"]}}}),l=n(89);const u=(0,l.Z)(c,[["render",a]]);var d=u,m=n(678);const w=[{path:"/",component:()=>Promise.resolve().then(n.bind(n,6047))}],h=(0,m.p7)({routes:w,history:(0,m.PO)()});var p=h,C=n(314),f=n(9545),v=n(4821),g=n(2691),k=n(3),T=n(2335),_=n(316),I=n(7619),y=n(3855),L=n(3708),S=n(5331),F=n(8321),b=n(9090);const Z=[f.zx,v.aV,g.iz,k.Ee,T.GI,_.JO,I.FN,y.od,L.gN,S.TS,F.kF];function P(t){for(const e of Z)t.component(e.name,e);t.use(b.J,{lazyComponent:!0})}function O(t){t.use(P)}n(5110);const U=(0,o.ri)(d);U.use(p),U.use(C.Z),U.use(O),U.mount("#app")},9302:function(t,e,n){n.d(e,{Z:function(){return w}});var o=n(7327),i=n(6265),r=n.n(i);const a=!0;class s{constructor(t){(0,o.Z)(this,"instance",void 0),(0,o.Z)(this,"interceptors",void 0),(0,o.Z)(this,"showLoading",void 0),this.instance=r().create(t),this.showLoading=t.showLoading??a,this.interceptors=t.interceptors,this.instance.interceptors.request.use(this.interceptors?.requestInterceptor,this.interceptors?.requestInterceptorCatch),this.instance.interceptors.response.use(this.interceptors?.responseInterceptor,this.interceptors?.responseInterceptorCatch),this.instance.interceptors.request.use((t=>(this.showLoading&&console.log("111"),t)),(t=>t)),this.instance.interceptors.response.use((t=>{const e=t.data;if("-1001"!==e.returnCode)return e;console.log("请求失败~, 错误信息")}),(t=>(404===t.response.status&&console.log("404的错误~"),t)))}request(t){return new Promise(((e,n)=>{t.interceptors?.requestInterceptor&&(t=t.interceptors.requestInterceptor(t)),!1===t.showLoading&&(this.showLoading=t.showLoading),this.instance.request(t).then((n=>{t.interceptors?.responseInterceptor&&(n=t.interceptors.responseInterceptor(n)),this.showLoading=a,e(n)})).catch((t=>(this.showLoading=a,n(t),t)))}))}get(t){return this.request({...t,method:"GET"})}post(t){return this.request({...t,method:"POST"})}delete(t){return this.request({...t,method:"DELETE"})}patch(t){return this.request({...t,method:"PATCH"})}}var c=s;let l="";const u=1e4;l="https://localhost:3000/api/v1/";var d=n(1156);const m=new c({baseURL:l,timeout:u,withCredentials:!0,interceptors:{requestInterceptor:t=>{const e=d.Z.getCache("_mixin_twitter");return e&&(t.headers.Authorization=`Bearer ${e}`),t},requestInterceptorCatch:t=>t,responseInterceptor:t=>t,responseInterceptorCatch:t=>t}});var w=m},8725:function(t,e,n){n.d(e,{_:function(){return o},e:function(){return r}});var o,i=n(9302);async function r(t,e,n){return i.Z.post({url:o.CreatePraiseTwitter,showLoading:!1,data:{tid:t,to_uuid:e,from_uuid:n}})}(function(t){t["CreatePraiseTwitter"]="/praisetwitter/create",t["DeletePraiseTwitter"]="/praisetwitter/delete",t["CheckPraiseTwitter"]="/praisetwitter/check"})(o||(o={}))},9246:function(t,e,n){n.d(e,{F:function(){return r},P:function(){return o}});var o,i=n(9302);async function r(t,e,n,r,a){return i.Z.post({url:o.CreateTwitterComment,showLoading:!1,data:{tid:t,content:e,from_uuid:n,from_user_name:r,from_user_avatar:a}})}(function(t){t["CreateTwitterComment"]="/twittercomment/create",t["DeleteTwitterComment"]="/twittercomment/delete",t["ListTwitterComment"]="/twittercomment/list"})(o||(o={}))},3943:function(t,e,n){n.d(e,{I:function(){return o},z:function(){return r}});var o,i=n(9302);async function r(t){let e=o.GetTwitterList;return t&&(e+="?page_token="+t),i.Z.get({url:e,showLoading:!1})}(function(t){t["GetTwitterList"]="/twitter/list",t["CreateTwitter"]="/twitter/create"})(o||(o={}))},314:function(t,e,n){n.d(e,{Z:function(){return T},o:function(){return k}});var o=n(65),i=(n(7658),n(3943));const r={namespaced:!0,state(){return{twitterList:[],pageToken:""}},actions:{async handleTwitterList({commit:t},e){const n=await(0,i.z)(e);t("appendTwitterList",n.data.list),t("changePageToken",n.data.pre_page_token)}},mutations:{changeTwitterList(t,e){t.twitterList=e},changePageToken(t,e){console.log("===================================="),console.log("changePageToken"),console.log("===================================="),t.pageToken=e},appendTwitterList(t,e){for(const n of e)t.twitterList.push(n)}},getters:{}};var a,s=r,c=n(9302);async function l(t){return c.Z.post({url:a.GetUserInfo,showLoading:!1,data:{uid:t}})}(function(t){t["GetUserInfo"]="/user/get"})(a||(a={}));const u={namespaced:!0,state(){return{UserInfo:{}}},actions:{async handleUserInfo({commit:t},e){const n=await l(e);t("changeUserInfo",n.data)},async handleMixinOauth({commit:t},e){const n="30aad5a5-e5f3-4824-9409-c2ff4152724e",o="PROFILE:READ",i="http://localhost:3000/api/v1/oauth/redirect";window.location.href=`https://mixin.one/oauth/authorize?client_id=${n}&scope=${o}&response_type=code&return_to=${i}`}},mutations:{changeUserInfo(t,e){t.UserInfo=e}},getters:{}};var d=u,m=n(8725);const w={namespaced:!0,state(){return{}},actions:{async handleCreatePraisetwiiter({commit:t},e){const{tid:n,from_uuid:o,to_uuid:i}=e;await(0,m.e)(n,i,o)}},mutations:{},getters:{}};var h=w,p=n(9246);async function C(t){return c.Z.get({url:p.P.ListTwitterComment+`?tid=${t}`,showLoading:!1})}const f={namespaced:!0,state(){return{TwitterCommentList:[]}},actions:{async handleShowTwitterCommentClick({commit:t},e){const n=await C(e);t("changeTwitterCommentList",n.data.list)}},mutations:{changeTwitterCommentList(t,e){t.TwitterCommentList=e}},getters:{}};var v=f;const g=(0,o.MT)({state:()=>({name:"lixin"}),mutations:{},getters:{},actions:{},modules:{user:d,main:s,praisetwiiter:h,twittercomment:v}});function k(){return(0,o.oR)()}var T=g},1156:function(t,e,n){var o=n(680);class i{setCache(t,e){o.Z.set(t,e)}getCache(t){return o.Z.get(t)}deleteCache(t){o.Z.remove(t)}}e["Z"]=new i},6047:function(t,e,n){n.r(e),n.d(e,{default:function(){return tt}});var o=n(3396),i=n(7139);const r={class:"main"};function a(t,e,n,a,s,c){const l=(0,o.up)("nav-bar"),u=(0,o.up)("van-divider"),d=(0,o.up)("TwitterItem"),m=(0,o.up)("van-list"),w=(0,o.up)("van-back-top"),h=(0,o.up)("van-popup"),p=(0,o.up)("comment-list");return(0,o.wg)(),(0,o.iD)("div",r,[(0,o.Wm)(l),(0,o.Wm)(u),(0,o.Wm)(m,{loading:t.loading,"onUpdate:loading":e[0]||(e[0]=e=>t.loading=e),finished:t.loadingFinished,"finished-text":"没有更多了",onLoad:t.loadingTwitter},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.twitterList,(e=>((0,o.wg)(),(0,o.j4)(d,{key:e,class:"twitter-item",twitter:e,onHandleTwitterItemClick:t.handleTwitterItemClick,onHandleCommentClick:t.handleCommentClick},null,8,["twitter","onHandleTwitterItemClick","onHandleCommentClick"])))),128))])),_:1},8,["loading","finished","onLoad"]),(0,o.Wm)(w),(0,o.Wm)(h,{round:"",show:t.isShowTwitterContent,"onUpdate:show":e[1]||(e[1]=e=>t.isShowTwitterContent=e),style:{padding:"64px"},onClickCloseIcon:t.handlePopupCloseClick},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(t.twitterContent),1)])),_:1},8,["show","onClickCloseIcon"]),(0,o.Wm)(p,{tid:t.tid,isShowTwitterComment:t.isShowTwitterComment,onChangeIsShowTwitterComment:t.changeIsShowTwitterComment},null,8,["tid","isShowTwitterComment","onChangeIsShowTwitterComment"])])}n(7658);var s=n(314),c=n(4870);const l={class:"twitter-item"},u={class:"user-name"};function d(t,e,n,r,a,s){const c=(0,o.up)("van-image"),d=(0,o.up)("van-icon");return(0,o.wg)(),(0,o.iD)("div",l,[(0,o.Wm)(c,{class:"user-avatar",src:t.twitter?.user_avatar,position:"left",round:"","lazy-load":""},null,8,["src"]),(0,o._)("p",u,(0,i.zw)(t.twitter?.user_name),1),(0,o._)("span",{class:"twitter-content",onClick:e[0]||(e[0]=(...e)=>t.handleContentClick&&t.handleContentClick(...e))},(0,i.zw)(t.twitter?.content),1),(0,o.Wm)(d,{name:"gold-coin-o",class:"reward",color:"#FAAB0C",size:"1.6rem",onClick:t.handleRewardClick},null,8,["onClick"]),(0,o.Wm)(d,{name:"comment-o",class:"comment",color:"#1989fa",size:"1.6rem",onClick:t.handleCommentClick},null,8,["onClick"]),(0,o.Wm)(d,{name:t.isLike,class:"like",color:"#EE0A24",size:"1.6rem",onClick:t.handleLikeClick},null,8,["name","onClick"])])}var m=n(8725),w=n(9302);async function h(t,e){return w.Z["delete"]({url:m._.DeletePraiseTwitter,showLoading:!1,data:{tid:t,from_uuid:e}})}async function p(t,e){return w.Z.post({url:m._.CheckPraiseTwitter,showLoading:!1,data:{tid:e,uid:t}})}var C=n(9936),f=(0,o.aZ)({props:{twitter:{type:Object,require:!0}},emits:["handleTwitterItemClick","handleCommentClick"],setup(t,{emit:e}){const n=(0,s.o)(),i=(0,o.Fl)((()=>n.state.user.UserInfo)),r=(0,c.iH)("like-o"),a=async()=>{if(!i.value.uid)return;const e=await p(i.value.uid,t.twitter?.ID);200===e.code&&(r.value="like")};a();const l=async()=>{if(i.value.uid)if("like-o"===r.value){const e=await(0,m.e)(t.twitter?.ID,t.twitter?.uid,i.value.uid);200===e.code?r.value="like":(0,C.CF)("Praise Failed!!")}else{const e=await h(t.twitter?.ID,i.value.uid);200===e.code?r.value="like-o":(0,C.CF)("Unpraise Failed!!")}else(0,C.CF)("请先登陆")},u=()=>{e("handleTwitterItemClick",t.twitter?.content)},d=()=>{e("handleCommentClick",t.twitter?.ID)},w=()=>{i.value.uid?(t.twitter?.uid||(0,C.CF)("Failed"),window.location.href=`mixin://transfer/${t.twitter?.uid}`):(0,C.CF)("请先登陆")};return{handleContentClick:u,isLike:r,handleLikeClick:l,handleCommentClick:d,handleRewardClick:w}}}),v=n(89);const g=(0,v.Z)(f,[["render",d],["__scopeId","data-v-cd37c408"]]);var k=g,T=k;const _={class:"nav-bar"};function I(t,e,n,i,r,a){const s=(0,o.up)("van-image"),c=(0,o.up)("van-button"),l=(0,o.up)("twitter-form");return(0,o.wg)(),(0,o.iD)("div",_,[t.userInfo.uid?((0,o.wg)(),(0,o.j4)(s,{key:0,width:"3rem",height:"3rem",src:t.userInfo?.avatar_url,position:"left",round:"","lazy-load":""},null,8,["src"])):(0,o.kq)("",!0),t.userInfo.uid?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(c,{key:1,class:"login-btn",round:"",color:"linear-gradient(to right, #5F9EA0, #87CEEB)",onClick:t.handleLoginClick},{default:(0,o.w5)((()=>[(0,o.Uk)(" 登陆 ")])),_:1},8,["onClick"])),t.userInfo.uid?((0,o.wg)(),(0,o.j4)(c,{key:2,class:"create-twitter-btn",onClick:t.handleCreateTwitter,round:"",color:"linear-gradient(to right, #00FFFF, #00BFFF)"},{default:(0,o.w5)((()=>[(0,o.Uk)("发布")])),_:1},8,["onClick"])):(0,o.kq)("",!0),(0,o.Wm)(l,{isShowTwitter:t.isShowTwitter,onChangeIsShowTwitter:t.changeIsShowTwitter},null,8,["isShowTwitter","onChangeIsShowTwitter"])])}const y={class:"twitter-form"};function L(t,e,n,r,a,s){const c=(0,o.up)("van-field"),l=(0,o.up)("van-button"),u=(0,o.up)("van-cell-group"),d=(0,o.up)("van-popup");return(0,o.wg)(),(0,o.iD)("div",y,[(0,o.Wm)(d,{show:t.isShow,"onUpdate:show":e[1]||(e[1]=e=>t.isShow=e),closeable:"",round:"",style:(0,i.j5)(t.popupStyle),onClickCloseIcon:t.handlePopupCloseClick,onClickOverlay:t.handlePopupCloseClick},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{inset:""},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{modelValue:t.twitterContent,"onUpdate:modelValue":e[0]||(e[0]=e=>t.twitterContent=e),rows:"1",autosize:"",label:"Twitter",type:"textarea",placeholder:"请输入留言","label-align":"top","show-word-limit":"",maxlength:"200"},null,8,["modelValue"]),(0,o.Wm)(l,{class:"create-twitter-btn",type:"primary",onClick:t.handleCreateClick},{default:(0,o.w5)((()=>[(0,o.Uk)("创建")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["show","style","onClickCloseIcon","onClickOverlay"])])}var S=n(3943);async function F(t,e,n,o){return w.Z.post({url:S.I.CreateTwitter,data:{uid:t,content:e,user_name:n,user_avatar:o}})}var b=(0,o.aZ)({props:{isShowTwitter:{type:Boolean,default:!1}},emits:["changeIsShowTwitter"],setup(t,{emit:e}){const n=(0,s.o)(),i=(0,o.Fl)((()=>n.state.user.UserInfo)),r=(0,c.iH)(!1),a=(0,c.iH)("");(0,o.YP)((()=>t.isShowTwitter),((t,e)=>{r.value=t}));const l=()=>{e("changeIsShowTwitter",!1)},u=async()=>{if(!i.value.uid)return void(0,C.CF)("Login first!");const t=await F(i.value.uid,a.value,i.value.user_name,i.value.avatar_url);200===t.code?((0,C.CF)("Succees!"),l(),a.value="",setTimeout((()=>{window.location.reload()}),1e3)):(0,C.CF)("Failed!")},d={padding:"1rem",width:"80%",height:"50%"};return{isShow:r,popupStyle:d,twitterContent:a,handlePopupCloseClick:l,handleCreateClick:u}}});const Z=(0,v.Z)(b,[["render",L],["__scopeId","data-v-e6d6534e"]]);var P=Z,O=P,U=(0,o.aZ)({components:{TwitterForm:O},setup(){const t=(0,s.o)(),e=(0,o.Fl)((()=>t.state.user.UserInfo)),n=(0,c.iH)(!1),i=t=>{n.value=t},r=()=>{t.dispatch("user/handleMixinOauth")},a=()=>{n.value=!0};return{userInfo:e,isShowTwitter:n,changeIsShowTwitter:i,handleLoginClick:r,handleCreateTwitter:a}}});const q=(0,v.Z)(U,[["render",I],["__scopeId","data-v-dd59e8c0"]]);var z=q,H=z;const W={class:"comment-list"};function D(t,e,n,i,r,a){const s=(0,o.up)("comment-item"),c=(0,o.up)("van-button"),l=(0,o.up)("van-field"),u=(0,o.up)("van-popup");return(0,o.wg)(),(0,o.iD)("div",W,[(0,o.Wm)(u,{round:"",show:t.isShow,"onUpdate:show":e[1]||(e[1]=e=>t.isShow=e),position:"bottom",style:{height:"60%"},onClickOverlay:t.handlePopupCloseClick},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.commentList,(t=>((0,o.wg)(),(0,o.j4)(s,{key:t,comment:t},null,8,["comment"])))),128)),(0,o.Wm)(l,{class:"comment-input",modelValue:t.commentValue,"onUpdate:modelValue":e[0]||(e[0]=e=>t.commentValue=e),label:"评论"},{button:(0,o.w5)((()=>[(0,o.Wm)(c,{size:"small",type:"primary",onClick:t.handleCommentClick},{default:(0,o.w5)((()=>[(0,o.Uk)("确定")])),_:1},8,["onClick"])])),_:1},8,["modelValue"])])),_:1},8,["show","onClickOverlay"])])}var j=n(9246);const x={class:"comment-item"},E={class:"from-user-name"},V={class:"content"},A={class:"created-at"};function M(t,e,n,r,a,s){const c=(0,o.up)("van-image");return(0,o.wg)(),(0,o.iD)("div",x,[(0,o.Wm)(c,{class:"from-user-avatar",src:t.comment?.from_user_avatar,round:"","lazy-load":""},null,8,["src"]),(0,o._)("span",E,(0,i.zw)(t.comment?.from_user_name),1),(0,o._)("span",V,(0,i.zw)(t.comment?.content),1),(0,o._)("span",A,(0,i.zw)(t.comment?.CreatedAt.substr(0,10)),1)])}var B=(0,o.aZ)({props:{comment:{type:Object,require:!1}},setup(t,{emit:e}){(0,s.o)();return{}}});const G=(0,v.Z)(B,[["render",M],["__scopeId","data-v-08c82a20"]]);var R=G,$=(0,o.aZ)({components:{CommentItem:R},props:{isShowTwitterComment:{type:Boolean,require:!0},tid:{type:Number,require:!0}},emits:["changeIsShowTwitterComment"],setup(t,{emit:e}){const n=(0,s.o)(),i=(0,c.iH)(""),r=(0,o.Fl)((()=>n.state.user.UserInfo)),a=(0,o.Fl)((()=>n.state.twittercomment.TwitterCommentList));let l=(0,c.iH)(!1);(0,o.YP)((()=>t.isShowTwitterComment),((t,e)=>{l.value=t}));const u=()=>{e("changeIsShowTwitterComment",!1)},d=async()=>{if(!r.value.uid)return void(0,C.CF)("请先登陆");const e=await(0,j.F)(t.tid,i.value,r.value.uid,r.value.user_name,r.value.avatar_url);200===e.code?((0,C.CF)("Success"),i.value="",setTimeout((()=>{n.dispatch("twittercomment/handleShowTwitterCommentClick",String(t.tid))}),1e3)):(0,C.CF)("Failed")};return{isShow:l,commentList:a,handlePopupCloseClick:u,commentValue:i,handleCommentClick:d}}});const N=(0,v.Z)($,[["render",D],["__scopeId","data-v-5e55d1ca"]]);var Y=N,J=Y,K=n(1156),Q=(0,o.aZ)({components:{TwitterItem:T,NavBar:H,CommentList:J},setup(){const t=(0,s.o)(),e=(0,c.iH)(!1),n=(0,c.iH)(!1),i=(0,c.iH)(""),r=(0,c.iH)(0),a=t=>{e.value=t},l=t=>{n.value=!0,i.value=t},u=()=>{i.value="",n.value=!1},d=n=>{e.value=!0,r.value=n,t.dispatch("twittercomment/handleShowTwitterCommentClick",String(n))},m=(0,o.Fl)((()=>t.state.main.pageToken)),w=(0,o.Fl)((()=>t.state.main.twitterList));t.dispatch("main/handleTwitterList",m.value),K.Z.getCache("_mixin_twitter")&&t.dispatch("user/handleUserInfo");const h=(0,c.iH)([]),p=(0,c.iH)(!1),C=(0,c.iH)(!1),f=()=>{setTimeout((()=>{for(let t=0;t<10;t++)h.value.push(h.value.length+1111);""!==m.value&&t.dispatch("main/handleTwitterList",m.value),p.value=!1,""===m.value&&(C.value=!0)}),1e3)};return{changeIsShowTwitterComment:a,isShowTwitterComment:e,isShowTwitterContent:n,twitterContent:i,handleTwitterItemClick:l,handlePopupCloseClick:u,twitterList:w,list:h,loadingTwitter:f,loading:p,loadingFinished:C,handleCommentClick:d,tid:r}}});const X=(0,v.Z)(Q,[["render",a],["__scopeId","data-v-27077f3c"]]);var tt=X}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o](r,r.exports,n),r.exports}n.m=t,function(){var t=[];n.O=function(e,o,i,r){if(!o){var a=1/0;for(u=0;u<t.length;u++){o=t[u][0],i=t[u][1],r=t[u][2];for(var s=!0,c=0;c<o.length;c++)(!1&r||a>=r)&&Object.keys(n.O).every((function(t){return n.O[t](o[c])}))?o.splice(c--,1):(s=!1,r<a&&(a=r));if(s){t.splice(u--,1);var l=i();void 0!==l&&(e=l)}}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[o,i,r]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var i,r,a=o[0],s=o[1],c=o[2],l=0;if(a.some((function(e){return 0!==t[e]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(c)var u=c(n)}for(e&&e(o);l<a.length;l++)r=a[l],n.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return n.O(u)},o=self["webpackChunkvue3_ts_template"]=self["webpackChunkvue3_ts_template"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(336)}));o=n.O(o)})();
//# sourceMappingURL=app.d3e5f082.js.map